#!/usr/bin/env node

require('dotenv').config();
const app = require('../app');
const pg = require('../lib/postgres');

// Your database configuration
const DATABASE_URL = process.env.DB_CONNECTION;

// Connect to postgres database
pg.initialize(DATABASE_URL, function(err) {
  if (err) {
    throw err;
  }

  // Which port to listen on
  app.set('port', process.env.PORT || 3000);

  // Start listening for HTTP requests
  const server = app.listen(app.get('port'), function() {
    const host = server.address().address;
    const port = server.address().port;

    console.log('Listening at http://%s:%s', host, port);
  });
});
